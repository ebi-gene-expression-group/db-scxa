sudo: required
language: r

services:
  - docker

before_install:
  - docker run -e POSTGRES_PASSWORD=postgresPass -e POSTGRES_USER=scxa -e POSTGRES_DB=scxa-test -p 5432:5432 -d postgres:10.3-alpine
  - echo 'options("repos"="http://cran.rstudio.com")' | sudo tee -a /etc/R/Rprofile.site

env:
  - dbConnection='postgresql://scxa:postgresPass@localhost/scxa-test'

install:
  - Rscript -e "install.packages('optparse', 'tidyr');"

script:
  - sleep 10 # lets give time for postgres to start
  - bash tests/run_tests.sh
